<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Badminton Fee Manager - S25 Ultra Edition</title>
    <style>
        :root { 
            --primary: #1a73e8; 
            --bg: #f8f9fa; 
            --danger: #ff4d4f;
            --input-bg: #ffffff;
        }

        /* T·ªëi ∆∞u cho m√†n h√¨nh ƒë·ªô ph√¢n gi·∫£i cao */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg); 
            margin: 0; 
            padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom) 12px;
            font-size: 14px; /* TƒÉng size ch·ªØ c∆° b·∫£n cho m√†n h√¨nh l·ªõn */
            color: #202124;
            line-height: 1.5;
        }

        .container { 
            max-width: 100%; /* T·∫≠n d·ª•ng h·∫øt chi·ªÅu ngang S25 Ultra */
            margin: auto; 
        }
        
        /* App Title */
        .app-title { 
            text-align: center; 
            background: var(--primary); 
            color: white; 
            padding: 16px; 
            border-radius: 12px 12px 0 0; 
            font-weight: 800; 
            font-size: 18px; 
            letter-spacing: 1.5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Sticky Header - C·ªë ƒë·ªãnh c√°c th√¥ng s·ªë ch√≠nh */
        .sticky-header { 
            position: sticky; 
            top: 0; 
            background: white; 
            z-index: 100; 
            padding: 15px; 
            border-radius: 0 0 16px 16px; 
            box-shadow: 0 8px 16px rgba(0,0,0,0.08); 
            margin-bottom: 15px; 
        }

        .input-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: 10px; 
        }

        .input-group { display: flex; flex-direction: column; align-items: center; }
        
        label { 
            font-size: 11px; 
            font-weight: 700; 
            color: #5f6368; 
            margin-bottom: 6px; 
            text-transform: uppercase;
        }

        .header-input { 
            width: 100%; 
            padding: 12px 5px; 
            border: 2px solid #e0e0e0; 
            border-radius: 10px; 
            font-size: 20px; /* Ch·ªØ to cho d·ªÖ nh√¨n */
            font-weight: bold; 
            text-align: center; 
            box-sizing: border-box;
            background: var(--input-bg);
            color: var(--primary);
        }

        /* Danh s√°ch th√†nh vi√™n - 1 d√≤ng tinh g·ªçn */
        .member-row { 
            background: white; 
            margin-bottom: 8px; 
            padding: 10px; 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            border: 1px solid #eee;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        /* T·ªâ l·ªá √¥ nh·∫≠p tr√™n S25 Ultra */
        .m-name { flex: 4; font-size: 15px; padding: 10px; border: 1.5px solid #ddd; border-radius: 8px; min-width: 0; font-weight: 600; }
        .m-count { flex: 1.2; font-size: 15px; text-align: center; padding: 10px; border: 1.5px solid #ddd; border-radius: 8px; background: #e8f0fe; font-weight: 800; color: #1a73e8; }
        .m-time { flex: 1.5; font-size: 15px; text-align: center; padding: 10px; border: 1.5px solid #ddd; border-radius: 8px; background: #fffde7; font-weight: 800; color: #f57f17; }
        
        .btn-del { 
            background: #fff; 
            color: var(--danger); 
            border: 2px solid #ffccc7; 
            width: 36px; 
            height: 36px; 
            border-radius: 50%; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 16px; 
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* Options */
        .options-box { 
            background: #fff; 
            padding: 14px; 
            border-radius: 12px; 
            margin: 15px 0; 
            display: flex; 
            justify-content: space-around; 
            border: 1px solid #ddd; 
        }

        .option-item { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-weight: 700; 
            color: #444; 
            font-size: 13px;
        }
        
        .option-item input { width: 20px; height: 20px; }

        /* Buttons ch√≠nh */
        .actions { margin-top: 15px; padding-bottom: 20px; }
        button.main-btn { 
            width: 100%; 
            padding: 18px; 
            border-radius: 14px; 
            border: none; 
            font-weight: bold; 
            font-size: 17px; 
            cursor: pointer; 
            margin-bottom: 12px; 
            transition: transform 0.1s;
        }
        button.main-btn:active { transform: scale(0.98); }

        .btn-add { background: #fff; border: 2.5px dashed var(--primary); color: var(--primary); }
        .btn-calc { background: var(--primary); color: white; box-shadow: 0 6px 15px rgba(26,115,232,0.3); }
        
        /* B·∫£ng Bill */
        #ketQua { margin-top: 15px; display: none; }
        table { 
            width: 100%; 
            border-collapse: separate; 
            border-spacing: 0;
            background: white; 
            border-radius: 14px; 
            overflow: hidden; 
            font-size: 14px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        }
        th, td { border-bottom: 1px solid #f0f0f0; padding: 14px 8px; text-align: center; }
        th { background: #fafafa; color: #888; font-size: 11px; text-transform: uppercase; font-weight: 800; }
        
        .summary-row { background: #f0f7ff; font-weight: bold; color: #0056b3; }
        .total-row { font-weight: 900; background: #f6ffed; color: #389e0d; font-size: 16px; }
        .profit-row { background: #fff7e6; color: #d46b08; font-weight: 900; font-size: 16px; border-top: 2px solid #ffd591; }
        
        .copy-btn { background: #52c41a; color: white; margin-bottom: 50px; }
        .hide-col { display: none !important; }

        /* Hi·ªáu ·ª©ng focus */
        input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26,115,232,0.1); }
    </style>
</head>
<body>

<div class="container">
    <div class="app-title">üè∏ BADMINTON FEE MANAGER</div>
    
    <div class="sticky-header">
        <div class="input-grid">
            <div class="input-group">
                <label>S·ªê S√ÇN</label>
                <input type="number" id="soSan" class="header-input" value="1">
            </div>
            <div class="input-group">
                <label>GI·ªú/S√ÇN</label>
                <input type="number" id="soGio" class="header-input" value="2">
            </div>
            <div class="input-group">
                <label>S·ªê C·∫¶U</label>
                <input type="number" id="soCau" class="header-input" value="10">
            </div>
        </div>
    </div>

    <div id="memberList"></div>

    <div class="options-box">
        <label class="option-item"><input type="checkbox" id="optCount" checked> HI·ªÜN SL</label>
        <label class="option-item"><input type="checkbox" id="optTime" checked> HI·ªÜN PH√öT</label>
    </div>

    <div class="actions">
        <button class="main-btn btn-add" onclick="addMember('', 1, 120)">+ TH√äM NH√Ä / NG∆Ø·ªúI</button>
        <button class="main-btn btn-calc" onclick="tinhTien()">XU·∫§T BILL & L√ÄM TR√íN</button>
        <button id="btnCopy" class="main-btn copy-btn" style="display:none" onclick="copyBill()">SAO CH√âP BILL G·ª¨I NH√ìM</button>
    </div>

    <div id="ketQua">
        <table id="billTable">
            <thead>
                <tr>
                    <th style="text-align:left; padding-left:15px;">T√äN</th>
                    <th class="col-count">SL</th>
                    <th class="col-time">PH√öT</th>
                    <th>TI·ªÄN ($)</th>
                </tr>
            </thead>
            <tbody id="billBody"></tbody>
        </table>
    </div>
</div>

<script>
    const GIA_SAN_1H = 22;
    const GIA_CAU_1Q = 2.5;

    const danhSachGoc = [
        {n: "Nh√† Kh∆∞∆°ng", c: 4}, {n: "Nh√† H√†", c: 2}, {n: "Ph√°t", c: 1},
        {n: "Sam", c: 1}, {n: "T√¢n", c: 1}, {n: "Nh√† T√®o", c: 2},
        {n: "Nh√† Tu·∫•n", c: 2}, {n: "Anthony", c: 1}, {n: "Ho√†ng", c: 1}, {n: "H·∫£i", c: 1}
    ];

    const listDiv = document.getElementById('memberList');

    function addMember(name="", count=1, time=120) {
        const div = document.createElement('div');
        div.className = 'member-row';
        div.innerHTML = `
            <input type="text" class="m-name" value="${name}" placeholder="T√™n">
            <input type="number" class="m-count" value="${count}">
            <input type="number" class="m-time" value="${time}">
            <button class="btn-del" onclick="this.parentElement.remove()">‚úï</button>
        `;
        listDiv.appendChild(div);
    }

    danhSachGoc.forEach(i => addMember(i.n, i.c, 120));

    function tinhTien() {
        const soSan = parseFloat(document.getElementById('soSan').value) || 0;
        const soGio = parseFloat(document.getElementById('soGio').value) || 0;
        const soCau = parseFloat(document.getElementById('soCau').value) || 0;
        const showCount = document.getElementById('optCount').checked;
        const showTime = document.getElementById('optTime').checked;

        const tienSanGoc = soSan * soGio * GIA_SAN_1H;
        const tienCauGoc = soCau * GIA_CAU_1Q;
        const tongGoc = tienSanGoc + tienCauGoc;
        
        const names = document.getElementsByClassName('m-name');
        const counts = document.getElementsByClassName('m-count');
        const times = document.getElementsByClassName('m-time');

        let totalP = 0, totalMinPts = 0, groups = [];

        for (let i = 0; i < names.length; i++) {
            let n = names[i].value.trim();
            if (n) {
                let c = parseFloat(counts[i].value) || 0;
                let t = parseFloat(times[i].value) || 0;
                totalP += c;
                totalMinPts += (c * t);
                groups.push({n, c, t});
            }
        }

        if (totalMinPts === 0) return;

        const pricePerMin = tienSanGoc / totalMinPts;
        const pricePerShuttle = totalP > 0 ? (tienCauGoc / totalP) : 0;

        let tableHtml = "";
        let realTotal = 0;

        groups.forEach(g => {
            let cost = (g.c * g.t * pricePerMin) + (g.c * pricePerShuttle);
            let rounded = Math.ceil(cost * 10) / 10;
            realTotal += rounded;
            
            tableHtml += `<tr>
                <td style="text-align:left; padding-left:15px; font-weight:600; color:#333;">${g.n}</td>
                <td class="col-count ${showCount ? '' : 'hide-col'}">${g.c}</td>
                <td class="col-time ${showTime ? '' : 'hide-col'}">${g.t}</td>
                <td style="font-weight:800; color:#000;">${rounded.toFixed(1)}</td>
            </tr>`;
        });
        
        const spanCol = (showCount?1:0) + (showTime?1:0) + 1;
        tableHtml += `<tr class="summary-row"><td colspan="${spanCol}" style="text-align:right">T·ªîNG G·ªêC (${totalP} ng∆∞·ªùi | ${soCau} c·∫ßu):</td><td>$${tongGoc.toFixed(1)}</td></tr>`;
        tableHtml += `<tr class="total-row"><td colspan="${spanCol}" style="text-align:right">TH·ª∞C THU:</td><td>$${realTotal.toFixed(1)}</td></tr>`;
        tableHtml += `<tr class="profit-row"><td colspan="${spanCol}" style="text-align:right">TI·ªÄN L·ªúI:</td><td>$${(realTotal - tongGoc).toFixed(1)}</td></tr>`;

        document.querySelector('.col-count').classList.toggle('hide-col', !showCount);
        document.querySelector('.col-time').classList.toggle('hide-col', !showTime);

        document.getElementById('billBody').innerHTML = tableHtml;
        document.getElementById('ketQua').style.display = 'block';
        document.getElementById('btnCopy').style.display = 'block';
        
        // Cu·ªôn xu·ªëng k·∫øt qu·∫£ m∆∞·ª£t m√†
        setTimeout(() => {
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }, 100);
    }

    function copyBill() {
        const rows = document.querySelectorAll("#billTable tr");
        let text = "üè∏ BILL C·∫¶U L√îNG " + new Date().toLocaleDateString('vi-VN') + "\n";
        text += "--------------------------\n";
        
        rows.forEach((row) => {
            const cols = row.querySelectorAll("td:not(.hide-col), th:not(.hide-col)");
            let rowText = "";
            cols.forEach((col, idx) => {
                rowText += col.innerText + (idx === cols.length - 1 ? "" : " | ");
            });
            text += rowText + "\n";
        });
        
        navigator.clipboard.writeText(text).then(() => {
            const btn = document.getElementById('btnCopy');
            btn.innerText = "‚úÖ ƒê√É COPY!";
            btn.style.background = "#28a745";
            setTimeout(() => {
                btn.innerText = "SAO CH√âP BILL G·ª¨I NH√ìM";
                btn.style.background = "#52c41a";
            }, 2000);
        });
    }
</script>
</body>
</html>
