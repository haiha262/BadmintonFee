<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Badminton Fee Manager - S25 Ultra Edition</title>
    <style>
        :root { 
            --primary: #0b57d0; 
            --bg: #f8f9fa; 
            --card-bg: #ffffff;
            --danger: #d93025; 
            --success: #1e8e3e;
            --warning: #f9ab00;
            --text: #1f1f1f;
        }
        
        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding: 10px; 
            color: var(--text);
            -webkit-font-smoothing: antialiased;
        }
        
        .container { max-width: 500px; margin: auto; }
        
        /* App Title */
        .app-title { 
            text-align: center; 
            background: var(--primary); 
            color: white; 
            padding: 15px; 
            border-radius: 16px 16px 4px 4px; 
            font-weight: 700; 
            font-size: 18px; 
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Sticky Header */
        .sticky-header { 
            position: sticky; 
            top: 0; 
            background: white; 
            z-index: 100; 
            padding: 15px; 
            border-radius: 0 0 16px 16px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            margin-bottom: 12px; 
        }
        
        .input-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .input-group { display: flex; flex-direction: column; align-items: center; }
        label { font-size: 10px; font-weight: 700; color: #5f6368; text-transform: uppercase; margin-bottom: 6px; }
        
        .header-input { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #dadce0; 
            border-radius: 8px; 
            font-size: 16px; 
            font-weight: 700; 
            text-align: center; 
            box-sizing: border-box; 
            color: var(--primary);
            background: #fdfdfd;
        }
        .header-input:focus { border-color: var(--primary); outline: none; background: white; }

        /* Member Row - Compact & Clean */
        .member-row { 
            background: var(--card-bg); 
            margin-bottom: 6px; 
            padding: 8px 10px; 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            border: 1px solid #e0e0e0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }
        
        .m-name { flex: 3.5; font-size: 14px; padding: 8px; border: 1px solid #eee; border-radius: 6px; min-width: 0; font-weight: 500; }
        .m-count { flex: 1; font-size: 14px; text-align: center; padding: 8px; border: 1px solid #eee; border-radius: 6px; background: #f1f3f4; font-weight: 700; }
        .m-time { flex: 1.2; font-size: 14px; text-align: center; padding: 8px; border: 1px solid #eee; border-radius: 6px; background: #fffde7; font-weight: 700; }
        
        .btn-del { 
            background: #fff; 
            color: var(--danger); 
            border: 1.5px solid #fce8e6; 
            width: 32px; height: 32px; 
            border-radius: 50%; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 16px; 
            flex-shrink: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .btn-del:active { background: #fce8e6; transform: scale(0.9); }

        /* Options Box */
        .options-box { 
            background: #fff; 
            padding: 12px; 
            border-radius: 12px; 
            margin: 10px 0; 
            display: flex; 
            justify-content: space-around; 
            border: 1px solid #e0e0e0;
        }
        .option-item { display: flex; align-items: center; gap: 8px; font-weight: 600; color: #444; cursor: pointer; font-size: 13px; }
        .option-item input { width: 18px; height: 18px; cursor: pointer; }

        /* Buttons */
        .actions { margin-top: 15px; padding: 0 5px; }
        button.main-btn { 
            width: 100%; 
            padding: 16px; 
            border-radius: 12px; 
            border: none; 
            font-weight: 700; 
            font-size: 15px; 
            cursor: pointer; 
            margin-bottom: 10px; 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-add { background: #fff; border: 2px dashed #dadce0; color: var(--primary); }
        .btn-add:active { background: #f1f3f4; }
        
        .btn-calc { 
            background: var(--primary); 
            color: white; 
            box-shadow: 0 4px 12px rgba(11, 87, 208, 0.25); 
        }
        .btn-calc:active { transform: scale(0.98); box-shadow: 0 2px 6px rgba(11, 87, 208, 0.2); }
        
        /* Result Table */
        #ketQua { margin-top: 20px; display: none; padding-bottom: 40px; }
        table { 
            width: 100%; 
            border-collapse: separate; 
            border-spacing: 0;
            background: white; 
            border-radius: 16px; 
            overflow: hidden; 
            font-size: 13px; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border: 1px solid #eee;
        }
        th, td { padding: 14px 8px; text-align: center; border-bottom: 1px solid #f1f1f1; }
        th { background: #f8f9fa; color: #5f6368; font-size: 11px; text-transform: uppercase; font-weight: 700; }
        
        .summary-row { background: #f1f3f4; font-weight: 600; color: #444; }
        .total-row { font-weight: 800; background: #e6f4ea; color: var(--success); font-size: 14px; }
        .profit-row { background: #fef7e0; color: #b06000; font-weight: 800; border-top: 1px solid #feefc3; }
        
        .copy-btn { background: var(--success); color: white; margin-top: 12px; }
        .hide-col { display: none !important; }
    </style>
</head>
<body>

<div class="container">
    <div class="app-title">BADMINTON FEE MANAGER</div>
    
    <div class="sticky-header">
        <div class="input-grid">
            <div class="input-group">
                <label>S·ªê S√ÇN</label>
                <input type="number" id="soSan" class="header-input" value="1">
            </div>
            <div class="input-group">
                <label>GI·ªú/S√ÇN</label>
                <input type="number" id="soGio" class="header-input" value="2">
            </div>
            <div class="input-group">
                <label>S·ªê C·∫¶U</label>
                <input type="number" id="soCau" class="header-input" value="10">
            </div>
        </div>
    </div>

    <div id="memberList"></div>

    <div class="options-box">
        <label class="option-item"><input type="checkbox" id="optCount" checked> Hi·ªán SL</label>
        <label class="option-item"><input type="checkbox" id="optTime" checked> Hi·ªán Ph√∫t</label>
    </div>

    <div class="actions">
        <button class="main-btn btn-add" onclick="addMember('', 1, 120)">+ TH√äM NG∆Ø·ªúI CH∆†I</button>
        <button class="main-btn btn-calc" onclick="tinhTien()">XU·∫§T BI√äN LAI</button>
        <button id="btnCopy" class="main-btn copy-btn" style="display:none" onclick="copyBill()">SAO CH√âP G·ª¨I NH√ìM</button>
    </div>

    <div id="ketQua">
        <table id="billTable">
            <thead>
                <tr>
                    <th style="text-align:left; padding-left:15px;">Th√†nh vi√™n</th>
                    <th class="col-count">SL</th>
                    <th class="col-time">Ph√∫t</th>
                    <th>Ti·ªÅn ($)</th>
                </tr>
            </thead>
            <tbody id="billBody"></tbody>
        </table>
    </div>
</div>

<script>
    const GIA_SAN_1H = 22;
    const GIA_CAU_1Q = 2.5;

    const danhSachGoc = [
        {n: "Nh√† Kh∆∞∆°ng", c: 4}, {n: "Nh√† H√†", c: 2}, {n: "Ph√°t", c: 1},
        {n: "Sam", c: 1}, {n: "T√¢n", c: 1}, {n: "Nh√† T√®o", c: 2},
        {n: "Nh√† Tu·∫•n", c: 2}, {n: "Anthony", c: 1}, {n: "Ho√†ng", c: 1}, {n: "H·∫£i", c: 1}
    ];

    const listDiv = document.getElementById('memberList');

    function addMember(name="", count=1, time=120) {
        const div = document.createElement('div');
        div.className = 'member-row';
        div.innerHTML = `
            <input type="text" class="m-name" value="${name}" placeholder="T√™n...">
            <input type="number" class="m-count" value="${count}">
            <input type="number" class="m-time" value="${time}">
            <button class="btn-del" onclick="this.parentElement.remove()">‚úï</button>
        `;
        listDiv.appendChild(div);
    }

    danhSachGoc.forEach(i => addMember(i.n, i.c, 120));

    function tinhTien() {
        const soSan = parseFloat(document.getElementById('soSan').value) || 0;
        const soGio = parseFloat(document.getElementById('soGio').value) || 0;
        const soCau = parseFloat(document.getElementById('soCau').value) || 0;
        const showCount = document.getElementById('optCount').checked;
        const showTime = document.getElementById('optTime').checked;

        const tienSanGoc = soSan * soGio * GIA_SAN_1H;
        const tienCauGoc = soCau * GIA_CAU_1Q;
        const tongGoc = tienSanGoc + tienCauGoc;
        
        const names = document.getElementsByClassName('m-name');
        const counts = document.getElementsByClassName('m-count');
        const times = document.getElementsByClassName('m-time');

        let totalP = 0, totalMinPts = 0, groups = [];

        for (let i = 0; i < names.length; i++) {
            let n = names[i].value.trim();
            if (n) {
                let c = parseFloat(counts[i].value) || 0;
                let t = parseFloat(times[i].value) || 0;
                totalP += c;
                totalMinPts += (c * t);
                groups.push({n, c, t});
            }
        }

        if (totalMinPts === 0) return;

        const pricePerMin = tienSanGoc / totalMinPts;
        const pricePerShuttle = totalP > 0 ? (tienCauGoc / totalP) : 0;

        let tableHtml = "";
        let realTotal = 0;

        groups.forEach(g => {
            let cost = (g.c * g.t * pricePerMin) + (g.c * pricePerShuttle);
            let rounded = Math.ceil(cost * 10) / 10;
            realTotal += rounded;
            
            tableHtml += `<tr>
                <td style="text-align:left; padding-left:15px; font-weight:600; color:#333;">${g.n}</td>
                <td class="col-count ${showCount ? '' : 'hide-col'}">${g.c}</td>
                <td class="col-time ${showTime ? '' : 'hide-col'}">${g.t}</td>
                <td style="font-weight:700; color:#000;">${rounded.toFixed(1)}</td>
            </tr>`;
        });
        
        const spanCol = (showCount?1:0) + (showTime?1:0) + 1;
        tableHtml += `<tr class="summary-row"><td colspan="${spanCol}" style="text-align:right">T·ªîNG G·ªêC (${totalP} ng∆∞·ªùi):</td><td>$${tongGoc.toFixed(1)}</td></tr>`;
        tableHtml += `<tr class="total-row"><td colspan="${spanCol}" style="text-align:right">TH·ª∞C THU:</td><td>$${realTotal.toFixed(1)}</td></tr>`;
        tableHtml += `<tr class="profit-row"><td colspan="${spanCol}" style="text-align:right">D∆Ø (L·ªúI):</td><td>$${(realTotal - tongGoc).toFixed(1)}</td></tr>`;

        document.querySelector('.col-count').classList.toggle('hide-col', !showCount);
        document.querySelector('.col-time').classList.toggle('hide-col', !showTime);

        document.getElementById('billBody').innerHTML = tableHtml;
        document.getElementById('ketQua').style.display = 'block';
        document.getElementById('btnCopy').style.display = 'block';
        
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function copyBill() {
        const rows = document.querySelectorAll("#billTable tr");
        let text = "üè∏ BILL C·∫¶U L√îNG " + new Date().toLocaleDateString('vi-VN') + "\n";
        text += "--------------------------\n";
        
        rows.forEach((row) => {
            const cols = row.querySelectorAll("td:not(.hide-col), th:not(.hide-col)");
            let rowText = "";
            cols.forEach((col, idx) => {
                rowText += col.innerText + (idx === cols.length - 1 ? "" : " | ");
            });
            text += rowText + "\n";
        });
        
        navigator.clipboard.writeText(text).then(() => {
            const btn = document.getElementById('btnCopy');
            btn.innerText = "ƒê√É SAO CH√âP!";
            btn.style.background = "#137333";
            setTimeout(() => {
                btn.innerText = "SAO CH√âP G·ª¨I NH√ìM";
                btn.style.background = "";
            }, 2000);
        });
    }
</script>
</body>
</html>
